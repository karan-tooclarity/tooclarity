"use client";
import React, { useState, useCallback, memo } from "react";
import { Mail, Phone, MapPin, ChevronDown } from "lucide-react";
import Link from "next/link";

// Constants for routes - centralized for easy maintenance/SEO
const FOOTER_ROUTES = {
  explore: [
    { label: "Kindergarten", href: "/student/blogs/kindergarten", prefetch: true },
    { label: "Schools", href: "/student/blogs/schools", prefetch: true },
    {
      label: "Tuition Centres",
      href: "/student/blogs/tuition",
      prefetch: true,
    },
    { label: "Intermediate", href: "/student/blogs/intermediate", prefetch: true },
    {
      label: "Graduation (UG/PG/Universities)",
      href: "/student/blogs/undergraduate",
      prefetch: true,
    },
    { label: "Upskilling", href: "/student/blogs/training", prefetch: true },
    {
      label: "Exam Preparation",
      href: "/student/blogs/study-halls",
      prefetch: true,
    },
    { label: "Study Abroad", href: "/student/blogs/study-abroad", prefetch: true },
  ],
  company: [
    { label: "About Us", href: "/student/AboutUs", prefetch: true },
    { label: "Careers", href: "/careers", prefetch: false }, // Less critical, no prefetch
    { label: "Privacy Policy", href: "/PrivacyPolicy", prefetch: false },
    { label: "Terms of Service", href: "/TermsConditions", prefetch: false },
  ],
  resources: [
    { label: "Blog", href: "/student/blogs", prefetch: true },
    { label: "Webinars", href: "/webinars", prefetch: false },
    { label: "Student Stories", href: "/student-stories", prefetch: true },
    {
      label: "Become A Campus Leader",
      href: "/campus-leader",
      prefetch: false,
    },
    { label: "Scholarships", href: "/scholarships", prefetch: true },
  ],
} as const;

const CONTACT_INFO = [
  {
    icon: <Mail className="w-4 h-4 text-gray-700 flex-shrink-0" />,
    label: "tooclarity@gmail.com",
  },
  {
    icon: <Phone className="w-4 h-4 text-gray-700 flex-shrink-0" />,
    label: "+91 88519 60009",
  },
  {
    icon: <MapPin className="w-4 h-4 text-gray-700 mt-1 flex-shrink-0" />,
    label: "Tarnaka, Secunderbad, Hyderabad 500007",
  },
];

type RouteItem = (typeof FOOTER_ROUTES)[keyof typeof FOOTER_ROUTES][number];
type ContactItem = (typeof CONTACT_INFO)[number];

interface SectionProps {
  sectionKey: string; // Renamed to avoid conflict with React's 'key' prop
  title: string;
  items: readonly RouteItem[] | readonly ContactItem[];
  isOpen: boolean;
  onToggle: () => void;
  isContact?: boolean;
}

const Section = memo<SectionProps>( // Changed 'key' to 'sectionKey' in destructuring
  ({ sectionKey, title, items, isOpen, onToggle, isContact }) => (
    <div className="w-full md:w-auto">
      <button
        onClick={onToggle}
        className="flex items-center justify-between w-full md:pointer-events-none mb-4 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 rounded"
        aria-expanded={isOpen}
        aria-controls={`${sectionKey}-list`}
        role="button"
      >
        <h3 className="font-bold text-lg text-white">{title}</h3>
        {!isContact && (
          <ChevronDown
            className={`h-4 w-4 transition-transform md:hidden ${
              isOpen ? "rotate-180" : ""
            }`}
            aria-hidden="true"
          />
        )}
      </button>
      <ul
        id={`${sectionKey}-list`}
        className={`space-y-2 text-white text-sm sm:text-base transition-all duration-300 overflow-hidden ${
          isOpen
            ? "max-h-[500px] opacity-100"
            : "max-h-0 opacity-0 md:max-h-none md:opacity-100"
        }`}
        role={isOpen ? "region" : undefined}
      >
        {items.map((item, index) => (
          <li key={index}>
            {"href" in item ? (
              <Link
                href={item.href}
                prefetch={item.prefetch}
                className="hover:text-white transition-colors block py-1 focus:outline-none focus-visible:ring-2 focus-visible:ring-white rounded"
                tabIndex={!isOpen ? -1 : undefined} // Accessibility: only focusable when open
              >
                {item.label}
              </Link>
            ) : (
              <div className="flex items-center gap-2 py-1" role="listitem">
                {item.icon}
                <span className="text-white">{item.label}</span>
              </div>
            )}
          </li>
        ))}
      </ul>
    </div>
  )
);

Section.displayName = "FooterSection";

export default function Footer() {
  const [openSections, setOpenSections] = useState({
    explore: false,
    company: false,
    resources: false,
    contact: false,
  });

  const toggleSection = useCallback((key: keyof typeof openSections) => {
    setOpenSections((prev) => ({ ...prev, [key]: !prev[key] }));
  }, []);

  const sections = [
    {
      key: "explore" as const,
      title: "Explore",
      items: FOOTER_ROUTES.explore,
      isContact: false,
    },
    {
      key: "company" as const,
      title: "Company",
      items: FOOTER_ROUTES.company,
      isContact: false,
    },
    {
      key: "resources" as const,
      title: "Resources",
      items: FOOTER_ROUTES.resources,
      isContact: false,
    },
    {
      key: "contact" as const,
      title: "Contact Us",
      items: CONTACT_INFO,
      isContact: true,
    },
  ] as const;

  return (
    <>
      <footer
        className="bg-[#0222D7] overflow-y-hidden border-t py-8 sm:py-12 px-4 sm:px-6 lg:px-20"
        role="contentinfo"
      >
        <div className="max-w-7xl mx-auto flex flex-col items-center md:items-start">
          {/* Logo Section - Placeholder for logos with alt text for accessibility */}
          <div className="mb-8 sm:mb-10 flex flex-col items-center md:items-start w-full md:w-auto">
            {/* Desktop Logo */}
            <div className="hidden md:block">
              <svg
                width="1190"
                height="294"
                viewBox="0 0 1190 294"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M52.75 241V105.5H6V74.25H140.75V105.5H93.25V241H52.75ZM199.721 244.75C178.387 244.75 162.304 239.083 151.471 227.75C140.804 216.25 135.471 199.417 135.471 177.25C135.471 153.417 140.887 136.333 151.721 126C162.721 115.5 178.721 110.25 199.721 110.25C213.887 110.25 225.721 112.667 235.221 117.5C244.887 122.167 252.137 129.417 256.971 139.25C261.971 149.083 264.471 161.75 264.471 177.25C264.471 199.417 258.887 216.25 247.721 227.75C236.554 239.083 220.554 244.75 199.721 244.75ZM199.721 215C205.887 215 210.971 213.583 214.971 210.75C219.137 207.75 222.221 203.5 224.221 198C226.387 192.333 227.471 185.417 227.471 177.25C227.471 167.917 226.387 160.583 224.221 155.25C222.221 149.75 219.137 145.833 214.971 143.5C210.804 141 205.721 139.75 199.721 139.75C193.387 139.75 188.221 141 184.221 143.5C180.221 146 177.221 150 175.221 155.5C173.387 160.833 172.471 168.083 172.471 177.25C172.471 189.917 174.637 199.417 178.971 205.75C183.471 211.917 190.387 215 199.721 215ZM347.182 244.75C325.848 244.75 309.765 239.083 298.932 227.75C288.265 216.25 282.932 199.417 282.932 177.25C282.932 153.417 288.348 136.333 299.182 126C310.182 115.5 326.182 110.25 347.182 110.25C361.348 110.25 373.182 112.667 382.682 117.5C392.348 122.167 399.598 129.417 404.432 139.25C409.432 149.083 411.932 161.75 411.932 177.25C411.932 199.417 406.348 216.25 395.182 227.75C384.015 239.083 368.015 244.75 347.182 244.75ZM347.182 215C353.348 215 358.432 213.583 362.432 210.75C366.598 207.75 369.682 203.5 371.682 198C373.848 192.333 374.932 185.417 374.932 177.25C374.932 167.917 373.848 160.583 371.682 155.25C369.682 149.75 366.598 145.833 362.432 143.5C358.265 141 353.182 139.75 347.182 139.75C340.848 139.75 335.682 141 331.682 143.5C327.682 146 324.682 150 322.682 155.5C320.848 160.833 319.932 168.083 319.932 177.25C319.932 189.917 322.098 199.417 326.432 205.75C330.932 211.917 337.848 215 347.182 215ZM496.893 244.25C487.893 244.25 479.393 242.917 471.393 240.25C463.393 237.583 456.309 233.583 450.143 228.25C443.976 222.917 439.143 216.167 435.643 208C432.143 199.833 430.393 190.333 430.393 179.5C430.393 168 432.059 158 435.393 149.5C438.726 140.833 443.309 133.667 449.143 128C455.143 122.333 462.143 118.083 470.143 115.25C478.143 112.417 486.976 111 496.643 111C503.476 111 510.476 111.75 517.643 113.25C524.976 114.583 531.393 116.5 536.893 119V151C531.059 148.333 525.309 146.167 519.643 144.5C514.143 142.667 508.476 141.75 502.643 141.75C492.143 141.75 483.643 144.417 477.143 149.75C470.809 154.917 467.643 163.417 467.643 175.25C467.643 187.75 470.476 197.167 476.143 203.5C481.809 209.833 491.226 213 504.393 213C510.559 213 516.476 211.917 522.143 209.75C527.976 207.583 532.976 205.333 537.143 203V234.75C531.309 237.75 525.226 240.083 518.893 241.75C512.559 243.417 505.226 244.25 496.893 244.25ZM600.131 241H563.131V66.75H600.131V241ZM681.949 244.75C674.283 244.75 667.033 244 660.199 242.5C653.533 241.167 647.616 238.917 642.449 235.75C637.449 232.417 633.533 228 630.699 222.5C627.866 216.833 626.449 209.833 626.449 201.5C626.449 193.667 628.033 186.833 631.199 181C634.533 175.167 639.533 170.667 646.199 167.5C652.866 164.333 661.283 162.75 671.449 162.75C677.116 162.75 682.616 163.333 687.949 164.5C693.283 165.667 698.033 167.25 702.199 169.25C706.533 171.25 709.949 173.417 712.449 175.75L713.949 193.75C710.616 191.75 706.616 190.167 701.949 189C697.283 187.833 692.283 187.25 686.949 187.25C678.783 187.25 672.783 188.5 668.949 191C665.283 193.333 663.449 197.083 663.449 202.25C663.449 205.417 664.366 208.25 666.199 210.75C668.033 213.25 670.449 215.167 673.449 216.5C676.616 217.833 679.866 218.5 683.199 218.5C691.699 218.5 697.616 217.917 700.949 216.75C704.449 215.583 706.199 213.25 706.199 209.75V163.25C706.199 155.583 703.699 150.083 698.699 146.75C693.866 143.25 686.949 141.5 677.949 141.5C670.616 141.5 663.199 142.833 655.699 145.5C648.366 148 642.366 151.083 637.699 154.75V121.75C642.033 119.083 648.699 116.583 657.699 114.25C666.866 111.917 677.116 110.75 688.449 110.75C692.449 110.75 696.866 111.083 701.699 111.75C706.533 112.417 711.366 113.667 716.199 115.5C721.033 117.167 725.449 119.667 729.449 123C733.616 126.333 736.949 130.583 739.449 135.75C741.949 140.917 743.199 147.333 743.199 155L742.949 214.75C742.949 221.917 740.533 227.75 735.699 232.25C730.866 236.583 723.866 239.75 714.699 241.75C705.699 243.75 694.783 244.75 681.949 244.75ZM776.266 241V127.75C778.599 125.75 782.766 123.5 788.766 121C794.766 118.333 801.599 116 809.266 114C817.099 111.833 824.932 110.75 832.766 110.75C840.599 110.75 846.766 111.333 851.266 112.5C855.766 113.667 859.182 115.167 861.516 117V144.25C858.682 143.583 855.099 143.083 850.766 142.75C846.432 142.417 841.932 142.25 837.266 142.25C832.599 142.083 828.182 142.083 824.016 142.25C819.849 142.417 816.349 142.75 813.516 143.25V241H776.266ZM883.949 241V116.25H921.199L921.449 241H883.949ZM883.199 97.25V68.5H921.699V97.25H883.199ZM1006.48 246C991.816 246 980.899 242.583 973.732 235.75C966.566 228.75 962.982 218.917 962.982 206.25V143H944.482V114.5H962.982V79.75H1001.98V114.5H1029.73V143H1001.98V201.5C1001.98 205.833 1002.9 209.083 1004.73 211.25C1006.57 213.25 1009.65 214.25 1013.98 214.25C1016.48 214.25 1019.23 213.75 1022.23 212.75C1025.23 211.75 1027.73 210.5 1029.73 209V241C1026.23 242.833 1022.4 244.083 1018.23 244.75C1014.23 245.583 1010.32 246 1006.48 246ZM1085.5 290C1081.34 290 1077.25 289.583 1073.25 288.75C1069.25 287.917 1065.84 286.833 1063 285.5V255.25C1065.67 256.25 1068.17 256.917 1070.5 257.25C1072.84 257.75 1075.25 258 1077.75 258C1081.92 258 1085.5 257 1088.5 255C1091.67 253.167 1094.25 249.917 1096.25 245.25C1098.25 240.75 1099.84 234.583 1101 226.75L1101.75 248L1047.5 114.5H1090.25L1119 203.25H1115.25L1143.75 114.5H1183.75L1134 243C1129.5 254.667 1124.59 263.917 1119.25 270.75C1114.09 277.583 1108.67 282.5 1103 285.5C1097.34 288.5 1091.5 290 1085.5 290Z"
                  fill="white"
                />
              </svg>
            </div>
            {/* Mobile Logo */}
            <div className="md:hidden">
              <svg
                width="300"
                height="80"
                viewBox="0 0 364 87"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M15.825 72V31.35H1.8V21.975H42.225V31.35H27.975V72H15.825ZM59.9162 73.125C53.5162 73.125 48.6912 71.425 45.4412 68.025C42.2412 64.575 40.6412 59.525 40.6412 52.875C40.6412 45.725 42.2662 40.6 45.5162 37.5C48.8162 34.35 53.6162 32.775 59.9162 32.775C64.1662 32.775 67.7162 33.5 70.5662 34.95C73.4662 36.35 75.6412 38.525 77.0912 41.475C78.5912 44.425 79.3412 48.225 79.3412 52.875C79.3412 59.525 77.6662 64.575 74.3162 68.025C70.9662 71.425 66.1662 73.125 59.9162 73.125ZM59.9162 64.2C61.7662 64.2 63.2912 63.775 64.4912 62.925C65.7412 62.025 66.6662 60.75 67.2662 59.1C67.9162 57.4 68.2412 55.325 68.2412 52.875C68.2412 50.075 67.9162 47.875 67.2662 46.275C66.6662 44.625 65.7412 43.45 64.4912 42.75C63.2412 42 61.7162 41.625 59.9162 41.625C58.0162 41.625 56.4662 42 55.2662 42.75C54.0662 43.5 53.1662 44.7 52.5662 46.35C52.0162 47.95 51.7412 50.125 51.7412 52.875C51.7412 56.675 52.3912 59.525 53.6912 61.425C55.0412 63.275 57.1162 64.2 59.9162 64.2ZM104.154 73.125C97.7545 73.125 92.9295 71.425 89.6795 68.025C86.4795 64.575 84.8795 59.525 84.8795 52.875C84.8795 45.725 86.5045 40.6 89.7545 37.5C93.0545 34.35 97.8545 32.775 104.154 32.775C108.404 32.775 111.954 33.5 114.804 34.95C117.704 36.35 119.879 38.525 121.329 41.475C122.829 44.425 123.579 48.225 123.579 52.875C123.579 59.525 121.904 64.575 118.554 68.025C115.204 71.425 110.404 73.125 104.154 73.125ZM104.154 64.2C106.004 64.2 107.529 63.775 108.729 62.925C109.979 62.025 110.904 60.75 111.504 59.1C112.154 57.4 112.479 55.325 112.479 52.875C112.479 50.075 112.154 47.875 111.504 46.275C110.904 44.625 109.979 43.45 108.729 42.75C107.479 42 105.954 41.625 104.154 41.625C102.254 41.625 100.704 42 99.5045 42.75C98.3045 43.5 97.4045 44.7 96.8045 46.35C96.2545 47.95 95.9795 50.125 95.9795 52.875C95.9795 56.675 96.6295 59.525 97.9295 61.425C99.2795 63.275 101.354 64.2 104.154 64.2ZM149.068 72.975C146.368 72.975 143.818 72.575 141.418 71.775C139.018 70.975 136.893 69.775 135.043 68.175C133.193 66.575 131.743 64.55 130.693 62.1C129.643 59.65 129.118 56.8 129.118 53.55C129.118 50.1 129.618 47.1 130.618 44.55C131.618 41.95 132.993 39.8 134.743 38.1C136.543 36.4 138.643 35.125 141.043 34.275C143.443 33.425 146.093 33 148.993 33C151.043 33 153.143 33.225 155.293 33.675C157.493 34.075 159.418 34.65 161.068 35.4V45C159.318 44.2 157.593 43.55 155.893 43.05C154.243 42.5 152.543 42.225 150.793 42.225C147.643 42.225 145.093 43.025 143.143 44.625C141.243 46.175 140.293 48.725 140.293 52.275C140.293 56.025 141.143 58.85 142.843 60.75C144.543 62.65 147.368 63.6 151.318 63.6C153.168 63.6 154.943 63.275 156.643 62.625C158.393 61.975 159.893 61.3 161.143 60.6V70.125C159.393 71.025 157.568 71.725 155.668 72.225C153.768 72.725 151.568 72.975 149.068 72.975ZM180.039 72H168.939V19.725H180.039V72ZM204.585 73.125C202.285 73.125 200.11 72.9 198.06 72.45C196.06 72.05 194.285 71.375 192.735 70.425C191.235 69.425 190.06 68.1 189.21 66.45C188.36 64.75 187.935 62.65 187.935 60.15C187.935 57.8 188.41 55.75 189.36 54C190.36 52.25 191.86 50.9 193.86 49.95C195.86 49 198.385 48.525 201.435 48.525C203.135 48.525 204.785 48.7 206.385 49.05C207.985 49.4 209.41 49.875 210.66 50.475C211.96 51.075 212.985 51.725 213.735 52.425L214.185 57.825C213.185 57.225 211.985 56.75 210.585 56.4C209.185 56.05 207.685 55.875 206.085 55.875C203.635 55.875 201.835 56.25 200.685 57C199.585 57.7 199.035 58.825 199.035 60.375C199.035 61.325 199.31 62.175 199.86 62.925C200.41 63.675 201.135 64.25 202.035 64.65C202.985 65.05 203.96 65.25 204.96 65.25C207.51 65.25 209.285 65.075 210.285 64.725C211.335 64.375 211.86 63.675 211.86 62.625V48.675C211.86 46.375 211.11 44.725 209.61 43.725C208.16 42.675 206.085 42.15 203.385 42.15C201.185 42.15 198.96 42.55 196.71 43.35C194.51 44.1 192.71 45.025 191.31 46.125V36.225C192.61 35.425 194.61 34.675 197.31 33.975C200.06 33.275 203.135 32.925 206.535 32.925C207.735 32.925 209.06 33.025 210.51 33.225C211.96 33.425 213.41 33.8 214.86 34.35C216.31 34.85 217.635 35.6 218.835 36.6C220.085 37.6 221.085 38.875 221.835 40.425C222.585 41.975 222.96 43.9 222.96 46.2L222.885 64.125C222.885 66.275 222.16 68.025 220.71 69.375C219.26 70.675 217.16 71.625 214.41 72.225C211.71 72.825 208.435 73.125 204.585 73.125ZM232.88 72V38.025C233.58 37.425 234.83 36.75 236.63 36C238.43 35.2 240.48 34.5 242.78 33.9C245.13 33.25 247.48 32.925 249.83 32.925C252.18 32.925 254.03 33.1 255.38 33.45C256.73 33.8 257.755 34.25 258.455 34.8V42.975C257.605 42.775 256.53 42.625 255.23 42.525C253.93 42.425 252.58 42.375 251.18 42.375C249.78 42.325 248.455 42.325 247.205 42.375C245.955 42.425 244.905 42.525 244.055 42.675V72H232.88ZM265.185 72V34.575H276.36L276.435 72H265.185ZM264.96 28.875V20.25H276.51V28.875H264.96ZM301.945 73.5C297.545 73.5 294.27 72.475 292.12 70.425C289.97 68.325 288.895 65.375 288.895 61.575V42.6H283.345V34.05H288.895V23.625H300.595V34.05H308.92V42.6H300.595V60.15C300.595 61.45 300.87 62.425 301.42 63.075C301.97 63.675 302.895 63.975 304.195 63.975C304.945 63.975 305.77 63.825 306.67 63.525C307.57 63.225 308.32 62.85 308.92 62.4V72C307.87 72.55 306.72 72.925 305.47 73.125C304.27 73.375 303.095 73.5 301.945 73.5ZM325.651 86.7C324.401 86.7 323.176 86.575 321.976 86.325C320.776 86.075 319.751 85.75 318.901 85.35V76.275C319.701 76.575 320.451 76.775 321.151 76.875C321.851 77.025 322.576 77.1 323.326 77.1C324.576 77.1 325.651 76.8 326.551 76.2C327.501 75.65 328.276 74.675 328.876 73.275C329.476 71.925 329.951 70.075 330.301 67.725L330.526 74.1L314.251 34.05H327.076L335.701 60.675H334.576L343.126 34.05H355.126L340.201 72.6C338.851 76.1 337.376 78.875 335.776 80.925C334.226 82.975 332.601 84.45 330.901 85.35C329.201 86.25 327.451 86.7 325.651 86.7Z"
                  fill="white"
                />
              </svg>
            </div>
          </div>

          {/* Links Section */}
          <div className="grid grid-cols-1 text-white md:grid-cols-4 gap-6 sm:gap-8 w-full">
            {sections.map((section) => (
              <Section
                key={section.key}
                title={section.title}
                items={section.items}
                isOpen={openSections[section.key]}
                onToggle={() => toggleSection(section.key)}
                isContact={section.isContact}
                sectionKey={""}
              />
            ))}
          </div>
        </div>

        {/* Footer Bottom - Full-width, accessible copyright */}
      </footer>
      <div className="bg-black flex flex-col sm:flex-row items-center justify-center text-center text-white text-sm py-4 border-t border-gray-700 w-full">
        <p className="flex items-center justify-center">
          &copy; Too Clarity 2025. All rights reserved.
        </p>
      </div>
    </>
  );
}
